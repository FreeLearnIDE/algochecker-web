{% extends "webapp/_layout.html" %}

{% block breadcrumb %}
    <ol class="breadcrumb">
        <li><a href="{{ url('index') }}">Home</a></li>
        <li><a href="{{ url('staff_dashboard') }}">Staff dashboard</a></li>
        <li><a href="{{ url('staff_group_tasks', args=[group.id]) }}">{{ group.name|truncate(35) }}</a></li>
        <li><a href="{{ url('staff_group_access', args=[group.id]) }}">Access control</a></li>
        <li class="active">Invitation list</li>
    </ol>
{% endblock %}

{% block body %}
    <h3 class="text-center">Invitations for &laquo;{{ group.name }}&raquo;</h3>
    <hr>
    {% if invitations %}
        <div class="table-responsive">
            <table class="table">
            <thead>
                <tr>
                    <th>Role</th>
                    <th>Sent to</th>
                    <th>Generated by</th>
                    <th>Generated at</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
            {% for inv in invitations %}
                <tr{% if not inv.check_valid() %} class="active text-muted"{% endif %}>
                    <td>
                        {{ inv.role }}
                    </td>
                    <td>
                        {{ inv.sent_to }}
                    </td>
                    <td>
                        {{ inv.created_by.first_name|short_name }} {{ inv.created_by.last_name }} <small>({{ inv.created_by.username }})</small>
                    </td>
                    <td>
                        {{ inv.creation_date|fltime }}
                    </td>
                    <td>
                        {% if inv.is_valid %}
                            <a href="{{ url('staff_group_revoke_invitation', args=[group.id, inv.id]) }}" class="btn btn-xs btn-danger"><span class="glyphicon glyphicon-remove"></span> revoke</a>
                        {% endif %}
                    </td>
                </tr>
            {% endfor %}
            </tbody>
            </table>
        </div>
        <p>Invitations shown in grey are already used or have been revoked. The invitation <span class="text-danger">expires</span> after <b>72 hours</b>.</p>
    {% else %}
        <div class="alert alert-info">
            <span class="glyphicon glyphicon-info-sign"></span> There are no invitations for this group
        </div>
    {% endif %}
{% endblock %}
